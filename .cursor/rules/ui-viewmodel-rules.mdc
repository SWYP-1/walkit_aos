---
description: "UI and ViewModel Rules for Jetpack Compose"
globs: ""
alwaysApply: true
---
# UI and ViewModel Rules

## Business Logic Separation

### ❌ Incorrect Pattern
```kotlin
@Composable
fun PlayerScreen() {
    Button(onClick = {
        // Business logic directly in UI - WRONG
    }) {
        Text("Button")
    }
}
```

### ✅ Correct Pattern
```kotlin
class PlayerViewModel() : ViewModel() {
    fun fetchPlayList() {
        // Business logic here
    }
}

@Composable
fun PlayerScreen(
    playerViewModel: PlayerViewModel
) {
    Button(onClick = {
        playerViewModel.fetchPlayList()
    }) {
        Text("Button")
    }
}
```

## ViewModel Organization Rules

### Higher-Level Feature Organization
Use one ViewModel per major feature, not per sub-feature.

**✅ DO THIS**: Single ViewModel for feature
```kotlin
class LiveViewModel {
    // One ViewModel handles all Live-related features
    fun handleStreaming() { ... }
    fun handleSettings() { ... }
    fun handleChat() { ... }
}
```

**❌ DON'T DO THIS**: Multiple ViewModels for sub-features
```kotlin
class LiveStreamViewModel { ... }  // WRONG
class LiveSettingViewModel { ... }  // WRONG
class LiveChatViewModel { ... }     // WRONG
```

## Composable Components
- Place reusable components in components/ directory
- Each component must be independent
- Follow theme system
- Consider accessibility (ContentDescription required)
- ViewModel naming: `FunctionName + ViewModel`
- Register in `../di/` using Hilt (use `@HiltViewModel` annotation)

## State Management
- Manage state in ViewModel
- Use StateFlow (see [coroutine-rules.mdc](mdc:.cursor/rules/coroutine-rules.mdc) for Flow usage)
- Follow Unidirectional Data Flow (UDF)
- Apply state hoisting pattern
- Use `remember` and `derivedStateOf` for expensive calculations

## Navigation
- Use Compose Navigation
- Support Deep Links
- Implement screen transition animations
- Handle backstack management

## Error Handling
- User-friendly error messages
- Implement retry mechanisms
- Error logging and analytics
- Use Result type for error handling (see [result-handling-rules.mdc](mdc:.cursor/rules/result-handling-rules.mdc))

## Code Style

### Naming Conventions
- Classes: PascalCase
- Functions: camelCase
- Variables: camelCase
- Constants: SCREAMING_SNAKE_CASE
- Composable Functions: PascalCase

### Composable Function Rules
- Must include Preview functions
- Parameters must have explicit default values
- Apply state hoisting
- Reusable components should be in separate files

### Code Formatting
- Indentation: 4 spaces
- Maximum line length: 120 characters
- Maximum function length: 50 lines
- Maximum file length: 500 lines
- Comments: Write in Korean
- Use KDoc format for documentation

### Technical Specifications
- **Language**: Kotlin
- **Framework**: Jetpack Compose
- **Architecture**: MVVM + Clean Architecture
- **File Coverage**: Write all parts without omission
